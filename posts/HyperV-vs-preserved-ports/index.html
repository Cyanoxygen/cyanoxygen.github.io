<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>干掉 Windows 下 Hyper-V HNS 服务的预留端口 | Reliena’s Garage</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="干掉 Windows 下 Hyper-V HNS 服务的预留端口" /><meta name="author" content="Reliena" /><meta property="og:locale" content="en_US" /><meta name="description" content="这是一篇关于 Hyper-V 端口预留过多导致大部分程序无法使用的问题的文章。我已经弃用了 WSL 2 和 Hyper-V。 出现问题到发现问题 自从将 Windows 10 升级到了 2004，并启用了 WSL 2 之后，我电脑里的一些程序和游戏就突然无法工作。 起初一直以为是玄学问题，直到有一天我发现我的一个 Web 始终没有跑起来。经过一番排查，发现它始终无法绑定端口。 用 netstat -abn 也没有发现该端口有被占用的迹象。 于是 python3 -m http.server 1234，Server 没有跑起来，抛了个异常就溜之大吉，错误码是 WSAEACCES : 1 OSError: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions 换了好几个端口，其中有大部分端口都无法绑定。为了查看有多少端口不能用，我简单写了一个脚本，当时的测试结果为： 在几个小时的搜索之后，发现 Stack Overflow 上也有人出现了相同的问题。该问题指出，使用 Docker for Windows 时不能绑定端口，无法正常使用容器。 其中优质回答将问题矛头直指 Hyper-V，引用了一个 GitHub issue，表示 Hyper-V 在启用之后向系统预留了一大堆端口，可以使用下面的命令查看： 1 netsh int ipv4 show excludedportrange protocol=tcp 执行了一遍，发现脚本报告的不能绑定的端口并不是全部： Hyper-V 你在干嘛？预留这么多端口作甚？你要知道我们都没法正常用电脑了！ 解决方法？ 根据 GitHub 和 Stack Overflow 上回答的描述，总结了一下可能的解决方法。这些解决方案均来自 GitHub 和其他网站，不保证其可用性。 下面列出的方法不一定是最优解。我选择了彻底放弃 Hyper-V 和 WSL 2，因为实在是太麻烦了，而且和 Hyper-V 共存下的虚拟机软件效率低得惊人。 禁用 Hyper-V ，手动预留端口并重新启用 禁用 Hyper-V ，手动预留你想要使用的端口之后再重新启用，此时 Hyper-V 预留端口时就动不到你预留过的端口了。 举个例子：假设你的常用端口在 1234 - 2345 之间，你需要在禁用 Hyper-V 之后手动预留这个范围的端口，然后重新启用 Hyper-V 时 Hyper-V 就不会再抢占这些端口了。 要禁用 Hyper-V，你可以使用 控制面板 - 程序 - 打开或关闭 Windows 功能 ，取消勾选下面的所有项目： Hyper-V Windows Hypervisior Platform Virtual Machine Platform 或者使用命令行，如果你只开启了 Hyper-V： 1 dism.exe /Online /Disable-Feature:Microsoft-Hyper-V 禁用完成会提示重启。重启电脑，然后预留你经常使用的端口： 假设你的常用端口范围是 1234 - 2345： 1 netsh int ipv4 add excludedportrange protocol=tcp startport=1234 numberofports=1112 这表示预留从 1234 端口开始的 1112 个端口，也就是 1234 - 2345。 如果你有很多段端口要使用，可以重复执行上述命令。 在你完成全部操作之后，可以返回原路重新启用 Hyper-V 及其相关组件了。在这之后，你的端口使用将不会再受到影响。 不过 GitHub issue 那边有人指出这个操作会导致虚拟网卡不工作。 用注册表更改动态端口范围为不常用范围 在 Stack Overflow的优质回答下面，有一个文章链接，该文章讲述了更改动态端口范围之后 Hyper-V 也会相应更改独占端口范围。 另外文章中还有这么一句话： Following a support call with Microsoft we were informed of an entirely (at time of writing) undocumented registry key ‘EnableExcludedPortRange’ to disable the excluded port range. 使用注册表键 EnableExcludedPortRange 似乎可以禁用独占端口。 不过测试系统是 Windows 10 1809，可能对新版本不适用。 文章里有一个脚本，脚本检测 Hyper-V 开启之后即修改动态端口范围，你可以根据需求选择需要的部分执行： 1 2 3 4 5 6 7 8 9 10 11 12 rem Modify Dynamic Port Range for Development Users dism /online /get-features | find /i &quot;Microsoft-Hyper-V&quot; &amp;&amp; ( rem Modify Dynamic Port Range start /wait &quot;&quot; netsh int ipv4 set dynamicport tcp start=20000 num=16384 start /wait &quot;&quot; netsh int ipv4 set dynamicport udp start=20000 num=16384 rem Add Registry Key start /wait &quot;&quot; reg add HKLM\SYSTEM\CurrentControlSet\Services\hns\State /v EnableExcludedPortRange /d 0 /f goto :eof ) 如果你想撤销更改，或者你已不再使用 Hyper-V，可以使用脚本的另一部分还原设置： 1 2 3 4 5 6 rem Set range to default start /wait &quot;&quot; netsh int ipv4 set dynamicport tcp start=49152 num=16384 start /wait &quot;&quot; netsh int ipv4 set dynamicport udp start=49152 num=16384 rem Remove Registry Key start /wait &quot;&quot; reg delete HKLM\SYSTEM\CurrentControlSet\Services\hns\State /v EnableExcludedPortRange /f 在这些步骤完成之后重启你的电脑，HNS 应该不会再霸占你需要的端口了。 Hyper-V 的端口预留为开发者造成了不少麻烦。为了 WSL 2，不得不使用 Hyper-V，没想到居然会带出这么多问题来。这些解决方案均来自 GitHub 和其他网站，不保证其可用性，因为我已经完全弃用了 Hyper-V/WSL 2，尽管在禁用之后还有两个虚拟网卡没有删除。" /><meta property="og:description" content="这是一篇关于 Hyper-V 端口预留过多导致大部分程序无法使用的问题的文章。我已经弃用了 WSL 2 和 Hyper-V。 出现问题到发现问题 自从将 Windows 10 升级到了 2004，并启用了 WSL 2 之后，我电脑里的一些程序和游戏就突然无法工作。 起初一直以为是玄学问题，直到有一天我发现我的一个 Web 始终没有跑起来。经过一番排查，发现它始终无法绑定端口。 用 netstat -abn 也没有发现该端口有被占用的迹象。 于是 python3 -m http.server 1234，Server 没有跑起来，抛了个异常就溜之大吉，错误码是 WSAEACCES : 1 OSError: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions 换了好几个端口，其中有大部分端口都无法绑定。为了查看有多少端口不能用，我简单写了一个脚本，当时的测试结果为： 在几个小时的搜索之后，发现 Stack Overflow 上也有人出现了相同的问题。该问题指出，使用 Docker for Windows 时不能绑定端口，无法正常使用容器。 其中优质回答将问题矛头直指 Hyper-V，引用了一个 GitHub issue，表示 Hyper-V 在启用之后向系统预留了一大堆端口，可以使用下面的命令查看： 1 netsh int ipv4 show excludedportrange protocol=tcp 执行了一遍，发现脚本报告的不能绑定的端口并不是全部： Hyper-V 你在干嘛？预留这么多端口作甚？你要知道我们都没法正常用电脑了！ 解决方法？ 根据 GitHub 和 Stack Overflow 上回答的描述，总结了一下可能的解决方法。这些解决方案均来自 GitHub 和其他网站，不保证其可用性。 下面列出的方法不一定是最优解。我选择了彻底放弃 Hyper-V 和 WSL 2，因为实在是太麻烦了，而且和 Hyper-V 共存下的虚拟机软件效率低得惊人。 禁用 Hyper-V ，手动预留端口并重新启用 禁用 Hyper-V ，手动预留你想要使用的端口之后再重新启用，此时 Hyper-V 预留端口时就动不到你预留过的端口了。 举个例子：假设你的常用端口在 1234 - 2345 之间，你需要在禁用 Hyper-V 之后手动预留这个范围的端口，然后重新启用 Hyper-V 时 Hyper-V 就不会再抢占这些端口了。 要禁用 Hyper-V，你可以使用 控制面板 - 程序 - 打开或关闭 Windows 功能 ，取消勾选下面的所有项目： Hyper-V Windows Hypervisior Platform Virtual Machine Platform 或者使用命令行，如果你只开启了 Hyper-V： 1 dism.exe /Online /Disable-Feature:Microsoft-Hyper-V 禁用完成会提示重启。重启电脑，然后预留你经常使用的端口： 假设你的常用端口范围是 1234 - 2345： 1 netsh int ipv4 add excludedportrange protocol=tcp startport=1234 numberofports=1112 这表示预留从 1234 端口开始的 1112 个端口，也就是 1234 - 2345。 如果你有很多段端口要使用，可以重复执行上述命令。 在你完成全部操作之后，可以返回原路重新启用 Hyper-V 及其相关组件了。在这之后，你的端口使用将不会再受到影响。 不过 GitHub issue 那边有人指出这个操作会导致虚拟网卡不工作。 用注册表更改动态端口范围为不常用范围 在 Stack Overflow的优质回答下面，有一个文章链接，该文章讲述了更改动态端口范围之后 Hyper-V 也会相应更改独占端口范围。 另外文章中还有这么一句话： Following a support call with Microsoft we were informed of an entirely (at time of writing) undocumented registry key ‘EnableExcludedPortRange’ to disable the excluded port range. 使用注册表键 EnableExcludedPortRange 似乎可以禁用独占端口。 不过测试系统是 Windows 10 1809，可能对新版本不适用。 文章里有一个脚本，脚本检测 Hyper-V 开启之后即修改动态端口范围，你可以根据需求选择需要的部分执行： 1 2 3 4 5 6 7 8 9 10 11 12 rem Modify Dynamic Port Range for Development Users dism /online /get-features | find /i &quot;Microsoft-Hyper-V&quot; &amp;&amp; ( rem Modify Dynamic Port Range start /wait &quot;&quot; netsh int ipv4 set dynamicport tcp start=20000 num=16384 start /wait &quot;&quot; netsh int ipv4 set dynamicport udp start=20000 num=16384 rem Add Registry Key start /wait &quot;&quot; reg add HKLM\SYSTEM\CurrentControlSet\Services\hns\State /v EnableExcludedPortRange /d 0 /f goto :eof ) 如果你想撤销更改，或者你已不再使用 Hyper-V，可以使用脚本的另一部分还原设置： 1 2 3 4 5 6 rem Set range to default start /wait &quot;&quot; netsh int ipv4 set dynamicport tcp start=49152 num=16384 start /wait &quot;&quot; netsh int ipv4 set dynamicport udp start=49152 num=16384 rem Remove Registry Key start /wait &quot;&quot; reg delete HKLM\SYSTEM\CurrentControlSet\Services\hns\State /v EnableExcludedPortRange /f 在这些步骤完成之后重启你的电脑，HNS 应该不会再霸占你需要的端口了。 Hyper-V 的端口预留为开发者造成了不少麻烦。为了 WSL 2，不得不使用 Hyper-V，没想到居然会带出这么多问题来。这些解决方案均来自 GitHub 和其他网站，不保证其可用性，因为我已经完全弃用了 Hyper-V/WSL 2，尽管在禁用之后还有两个虚拟网卡没有删除。" /><link rel="canonical" href="https://blog.cyanoxygen.xyz/posts/HyperV-vs-preserved-ports/" /><meta property="og:url" content="https://blog.cyanoxygen.xyz/posts/HyperV-vs-preserved-ports/" /><meta property="og:site_name" content="Reliena’s Garage" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-15T01:43:11+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="干掉 Windows 下 Hyper-V HNS 服务的预留端口" /><meta name="twitter:site" content="@ohCyan" /><meta name="twitter:creator" content="@Reliena" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"干掉 Windows 下 Hyper-V HNS 服务的预留端口","dateModified":"2020-08-15T01:43:11+08:00","datePublished":"2020-08-15T01:43:11+08:00","description":"这是一篇关于 Hyper-V 端口预留过多导致大部分程序无法使用的问题的文章。我已经弃用了 WSL 2 和 Hyper-V。 出现问题到发现问题 自从将 Windows 10 升级到了 2004，并启用了 WSL 2 之后，我电脑里的一些程序和游戏就突然无法工作。 起初一直以为是玄学问题，直到有一天我发现我的一个 Web 始终没有跑起来。经过一番排查，发现它始终无法绑定端口。 用 netstat -abn 也没有发现该端口有被占用的迹象。 于是 python3 -m http.server 1234，Server 没有跑起来，抛了个异常就溜之大吉，错误码是 WSAEACCES : 1 OSError: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions 换了好几个端口，其中有大部分端口都无法绑定。为了查看有多少端口不能用，我简单写了一个脚本，当时的测试结果为： 在几个小时的搜索之后，发现 Stack Overflow 上也有人出现了相同的问题。该问题指出，使用 Docker for Windows 时不能绑定端口，无法正常使用容器。 其中优质回答将问题矛头直指 Hyper-V，引用了一个 GitHub issue，表示 Hyper-V 在启用之后向系统预留了一大堆端口，可以使用下面的命令查看： 1 netsh int ipv4 show excludedportrange protocol=tcp 执行了一遍，发现脚本报告的不能绑定的端口并不是全部： Hyper-V 你在干嘛？预留这么多端口作甚？你要知道我们都没法正常用电脑了！ 解决方法？ 根据 GitHub 和 Stack Overflow 上回答的描述，总结了一下可能的解决方法。这些解决方案均来自 GitHub 和其他网站，不保证其可用性。 下面列出的方法不一定是最优解。我选择了彻底放弃 Hyper-V 和 WSL 2，因为实在是太麻烦了，而且和 Hyper-V 共存下的虚拟机软件效率低得惊人。 禁用 Hyper-V ，手动预留端口并重新启用 禁用 Hyper-V ，手动预留你想要使用的端口之后再重新启用，此时 Hyper-V 预留端口时就动不到你预留过的端口了。 举个例子：假设你的常用端口在 1234 - 2345 之间，你需要在禁用 Hyper-V 之后手动预留这个范围的端口，然后重新启用 Hyper-V 时 Hyper-V 就不会再抢占这些端口了。 要禁用 Hyper-V，你可以使用 控制面板 - 程序 - 打开或关闭 Windows 功能 ，取消勾选下面的所有项目： Hyper-V Windows Hypervisior Platform Virtual Machine Platform 或者使用命令行，如果你只开启了 Hyper-V： 1 dism.exe /Online /Disable-Feature:Microsoft-Hyper-V 禁用完成会提示重启。重启电脑，然后预留你经常使用的端口： 假设你的常用端口范围是 1234 - 2345： 1 netsh int ipv4 add excludedportrange protocol=tcp startport=1234 numberofports=1112 这表示预留从 1234 端口开始的 1112 个端口，也就是 1234 - 2345。 如果你有很多段端口要使用，可以重复执行上述命令。 在你完成全部操作之后，可以返回原路重新启用 Hyper-V 及其相关组件了。在这之后，你的端口使用将不会再受到影响。 不过 GitHub issue 那边有人指出这个操作会导致虚拟网卡不工作。 用注册表更改动态端口范围为不常用范围 在 Stack Overflow的优质回答下面，有一个文章链接，该文章讲述了更改动态端口范围之后 Hyper-V 也会相应更改独占端口范围。 另外文章中还有这么一句话： Following a support call with Microsoft we were informed of an entirely (at time of writing) undocumented registry key ‘EnableExcludedPortRange’ to disable the excluded port range. 使用注册表键 EnableExcludedPortRange 似乎可以禁用独占端口。 不过测试系统是 Windows 10 1809，可能对新版本不适用。 文章里有一个脚本，脚本检测 Hyper-V 开启之后即修改动态端口范围，你可以根据需求选择需要的部分执行： 1 2 3 4 5 6 7 8 9 10 11 12 rem Modify Dynamic Port Range for Development Users dism /online /get-features | find /i &quot;Microsoft-Hyper-V&quot; &amp;&amp; ( rem Modify Dynamic Port Range start /wait &quot;&quot; netsh int ipv4 set dynamicport tcp start=20000 num=16384 start /wait &quot;&quot; netsh int ipv4 set dynamicport udp start=20000 num=16384 rem Add Registry Key start /wait &quot;&quot; reg add HKLM\\SYSTEM\\CurrentControlSet\\Services\\hns\\State /v EnableExcludedPortRange /d 0 /f goto :eof ) 如果你想撤销更改，或者你已不再使用 Hyper-V，可以使用脚本的另一部分还原设置： 1 2 3 4 5 6 rem Set range to default start /wait &quot;&quot; netsh int ipv4 set dynamicport tcp start=49152 num=16384 start /wait &quot;&quot; netsh int ipv4 set dynamicport udp start=49152 num=16384 rem Remove Registry Key start /wait &quot;&quot; reg delete HKLM\\SYSTEM\\CurrentControlSet\\Services\\hns\\State /v EnableExcludedPortRange /f 在这些步骤完成之后重启你的电脑，HNS 应该不会再霸占你需要的端口了。 Hyper-V 的端口预留为开发者造成了不少麻烦。为了 WSL 2，不得不使用 Hyper-V，没想到居然会带出这么多问题来。这些解决方案均来自 GitHub 和其他网站，不保证其可用性，因为我已经完全弃用了 Hyper-V/WSL 2，尽管在禁用之后还有两个虚拟网卡没有删除。","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.cyanoxygen.xyz/posts/HyperV-vs-preserved-ports/"},"url":"https://blog.cyanoxygen.xyz/posts/HyperV-vs-preserved-ports/","author":{"@type":"Person","name":"Reliena"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Reliena’s Garage</a></div><div class="site-subtitle font-italic">Let’s build and ruin this world!</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/friends/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-user-friends ml-xl-3 mr-xl-3 unloaded"></i> <span>FRIENDS</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/cyanoxygen" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/ohCyan" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://cykc.xyz/d" target="_blank"> <i class="fab fa-discord"></i> </a> <a href="https://t.me/CyanCh" target="_blank"> <i class="fab fa-telegram"></i> </a> <a href=" javascript:window.open('mailto:' + ['i','cyanoxygen.xyz'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>干掉 Windows 下 Hyper-V HNS 服务的预留端口</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>干掉 Windows 下 Hyper-V HNS 服务的预留端口</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 15, 2020, 1:43 AM +0800" > Aug 15, 2020 <i class="unloaded">2020-08-15T01:43:11+08:00</i> </span> by <span class="author"> Reliena </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 15, 2020, 1:15 PM +0800" > Aug 15, 2020 <i class="unloaded">2020-08-15T13:15:09+08:00</i> </span></div></div><div class="post-content"><p>这是一篇关于 Hyper-V 端口预留过多导致大部分程序无法使用的问题的文章。<del>我已经弃用了 WSL 2 和 Hyper-V</del>。</p><h2 id="出现问题到发现问题">出现问题到发现问题</h2><p>自从将 Windows 10 升级到了 2004，并启用了 WSL 2 之后，我电脑里的一些程序和游戏就突然无法工作。 起初一直以为是玄学问题，直到有一天我发现我的一个 Web 始终没有跑起来。经过一番排查，发现它始终无法绑定端口。<br /> 用 <code class="language-plaintext highlighter-rouge">netstat -abn</code> 也没有发现该端口有被占用的迹象。</p><p>于是 <code class="language-plaintext highlighter-rouge">python3 -m http.server 1234</code>，Server 没有跑起来，抛了个异常就溜之大吉，错误码是 <code class="language-plaintext highlighter-rouge">WSAEACCES</code> :</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>OSError: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions
</pre></table></code></div></div><p>换了好几个端口，其中有大部分端口都无法绑定。为了查看有多少端口不能用，我简单写了一个<a href="https://gist.github.com/Cyanoxygen/64938614406508aa1ee0db266d2625e8">脚本</a>，当时的测试结果为：</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/porttest_1.jpg" alt="运行结果 1" /></p><p>在几个小时的搜索之后，发现 <a href="https://stackoverflow.com/a/54727281">Stack Overflow 上也有人出现了相同的问题</a>。该问题指出，使用 Docker for Windows 时不能绑定端口，无法正常使用容器。<br /> 其中优质回答将问题矛头直指 Hyper-V，引用了一个 <a href="https://github.com/docker/for-win/issues/3171#issuecomment-459205576">GitHub issue</a>，表示 Hyper-V 在启用之后向系统预留了一大堆端口，可以使用下面的命令查看：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>netsh int ipv4 show excludedportrange protocol=tcp
</pre></table></code></div></div><p>执行了一遍，发现脚本报告的不能绑定的端口并不是全部：</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/reserved_port_1.jpg" alt="Hyper-V 预留的端口" /></p><p>Hyper-V 你在干嘛？预留这么多端口作甚？你要知道我们都没法正常用电脑了！</p><h2 id="解决方法">解决方法？</h2><p>根据 GitHub 和 Stack Overflow 上回答的描述，总结了一下可能的解决方法。这些解决方案均来自 GitHub 和其他网站，不保证其可用性。</p><p>下面列出的方法不一定是最优解。我选择了彻底放弃 Hyper-V 和 WSL 2，因为实在是太麻烦了，而且和 Hyper-V 共存下的虚拟机软件效率低得惊人。</p><h3 id="禁用-hyper-v-手动预留端口并重新启用">禁用 Hyper-V ，手动预留端口并重新启用</h3><p>禁用 Hyper-V ，手动预留<em>你想要使用的端口</em>之后再重新启用，此时 Hyper-V 预留端口时就动不到你预留过的端口了。</p><p>举个例子：假设你的常用端口在 <code class="language-plaintext highlighter-rouge">1234</code> - <code class="language-plaintext highlighter-rouge">2345</code> 之间，你需要在禁用 Hyper-V 之后手动预留这个范围的端口，然后重新启用 Hyper-V 时 Hyper-V 就不会再抢占这些端口了。</p><p>要禁用 Hyper-V，你可以使用 <code class="language-plaintext highlighter-rouge">控制面板</code> - <code class="language-plaintext highlighter-rouge">程序</code> - <code class="language-plaintext highlighter-rouge">打开或关闭 Windows 功能</code> ，取消勾选下面的所有项目：</p><ul><li>Hyper-V</li><li>Windows Hypervisior Platform</li><li>Virtual Machine Platform</li></ul><p>或者使用命令行，如果你只开启了 Hyper-V：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dism.exe /Online /Disable-Feature:Microsoft-Hyper-V
</pre></table></code></div></div><p>禁用完成会提示重启。重启电脑，然后预留你经常使用的端口：</p><p>假设你的常用端口范围是 <code class="language-plaintext highlighter-rouge">1234</code> - <code class="language-plaintext highlighter-rouge">2345</code>：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>netsh int ipv4 add excludedportrange protocol=tcp startport=1234 numberofports=1112
</pre></table></code></div></div><p>这表示预留从 <code class="language-plaintext highlighter-rouge">1234</code> 端口开始的 1112 个端口，也就是 <code class="language-plaintext highlighter-rouge">1234</code> - <code class="language-plaintext highlighter-rouge">2345</code>。<br /> 如果你有很多段端口要使用，可以重复执行上述命令。</p><p>在你完成全部操作之后，可以返回原路重新启用 Hyper-V 及其相关组件了。在这之后，你的端口使用将不会再受到影响。</p><p>不过 GitHub issue 那边有人指出这个操作会导致虚拟网卡不工作。</p><h3 id="用注册表更改动态端口范围为不常用范围">用注册表更改动态端口范围为不常用范围</h3><p>在 Stack Overflow的优质回答下面，有一个<a href="https://dandini.wordpress.com/2019/07/15/administered-port-exclusions-blocking-high-ports/">文章链接</a>，该文章讲述了更改动态端口范围之后 Hyper-V 也会相应更改独占端口范围。</p><p>另外文章中还有这么一句话：</p><blockquote><p>Following a support call with Microsoft we were informed of an entirely (at time of writing) undocumented registry key ‘EnableExcludedPortRange’ to disable the excluded port range.</p></blockquote><p>使用注册表键 <code class="language-plaintext highlighter-rouge">EnableExcludedPortRange</code> 似乎可以禁用独占端口。</p><p>不过测试系统是 Windows 10 1809，可能对新版本不适用。</p><p>文章里有一个脚本，脚本检测 Hyper-V 开启之后即修改动态端口范围，你可以根据需求选择需要的部分执行：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>rem Modify Dynamic Port Range for Development Users
dism /online /get-features | find /i "Microsoft-Hyper-V" &amp;&amp; (
rem Modify Dynamic Port Range
start /wait "" netsh int ipv4 set dynamicport tcp start=20000 num=16384
start /wait "" netsh int ipv4 set dynamicport udp start=20000 num=16384

rem Add Registry Key
start /wait "" reg add HKLM\SYSTEM\CurrentControlSet\Services\hns\State /v EnableExcludedPortRange /d 0 /f

goto :eof

)
</pre></table></code></div></div><p>如果你想撤销更改，或者你已不再使用 Hyper-V，可以使用脚本的另一部分还原设置：</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>rem Set range to default
start /wait "" netsh int ipv4 set dynamicport tcp start=49152 num=16384
start /wait "" netsh int ipv4 set dynamicport udp start=49152 num=16384

rem Remove Registry Key
start /wait "" reg delete HKLM\SYSTEM\CurrentControlSet\Services\hns\State /v EnableExcludedPortRange /f
</pre></table></code></div></div><p>在这些步骤完成之后重启你的电脑，HNS 应该不会再霸占你需要的端口了。</p><hr /><p>Hyper-V 的端口预留为开发者造成了不少麻烦。为了 WSL 2，不得不使用 Hyper-V，没想到居然会带出这么多问题来。这些解决方案均来自 GitHub 和其他网站，不保证其可用性，因为我已经完全弃用了 Hyper-V/WSL 2，尽管在禁用之后还有两个虚拟网卡没有删除。</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/windows/'>Windows</a>, <a href='/categories/network/'>Network</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/eacces/" class="post-tag no-text-decoration" >eacces</a> <a href="/tags/network/" class="post-tag no-text-decoration" >network</a> <a href="/tags/hyperv/" class="post-tag no-text-decoration" >hyperv</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=干掉 Windows 下 Hyper-V HNS 服务的预留端口 - Reliena’s Garage&url=https://blog.cyanoxygen.xyz/posts/HyperV-vs-preserved-ports/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=干掉 Windows 下 Hyper-V HNS 服务的预留端口 - Reliena’s Garage&u=https://blog.cyanoxygen.xyz/posts/HyperV-vs-preserved-ports/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=干掉 Windows 下 Hyper-V HNS 服务的预留端口 - Reliena’s Garage&url=https://blog.cyanoxygen.xyz/posts/HyperV-vs-preserved-ports/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HyperV-vs-preserved-ports/">干掉 Windows 下 Hyper-V HNS 服务的预留端口</a></li><li><a href="/posts/Welcome/">Welcome to Reliena’s Garage!</a></li><li><a href="/posts/rpi-debian-bluetooth/">为运行非官方 Linux 的树莓派 4B 找回蓝牙功能</a></li><li><a href="/posts/rpi-debian/">为树莓派 4 安装纯净的 arm64 Debian GNU/Linux 系统</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/rpi/">rpi</a> <a class="post-tag" href="/tags/raspberrypi/">raspberrypi</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/welcome/">welcome</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/hyperv/">hyperv</a> <a class="post-tag" href="/tags/eacces/">eacces</a> <a class="post-tag" href="/tags/debian/">debian</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/rpi-debian-bluetooth/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 14, 2020 <i class="unloaded">2020-08-14T17:10:42+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>为运行非官方 Linux 的树莓派 4B 找回蓝牙功能</h3><div class="text-muted small"><p> 之前我在这篇文章描述了如何将树莓派官方的 Raspberry Pi OS 替换为 Debian GNU/Linux。但是随着我的需求变化，形同虚设的蓝牙就成了一个问题。我需要把周围的蓝牙设备（其实就是小爱同学）利用起来。经过一番研究，最终蓝牙也能工作了。 前言 树莓派的蓝牙不是 USB 连接的，而是连接在在 UART 上，使用 hciattach 将串口上的蓝牙注册为 HCI 设备。所...</p></div></div></a></div><div class="card"> <a href="/posts/rpi-debian/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Apr 9, 2020 <i class="unloaded">2020-04-09T16:44:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>为树莓派 4 安装纯净的 arm64 Debian GNU/Linux 系统</h3><div class="text-muted small"><p> 为树莓派 4 安装 arm64 的 Debian 树莓派 4 也出来好久了，最近有攒下来的零花钱可以买了，于是就买了一块。但因为我是 Debian Puriest, 所以不是很喜欢 Raspbian ，刚巧树莓派 4 也有了 64 位内核，就准备折腾为它安装一个纯净的 Debian 。话不多说，立即开始。 本文适用于想折腾的用户，需要一定的 Linux 基础知识。并且已经有其它方法来达到...</p></div></div></a></div><div class="card"> <a href="/posts/Welcome/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 12, 2019 <i class="unloaded">2019-08-12T14:21:30+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Welcome to Reliena’s Garage!</h3><div class="text-muted small"><p> 欢迎来到 Reliena’s Garage! Let’s build and ruin this world! 这是 Reliena，一个爱好技术和运维的新手蛋子。平时坐在电脑前有时折腾，有时娱乐，有时…毁灭。玩音游，水平不高。 人品自评比较好，认识我的人的评价一般不会低。现实中比较害羞，网络上口若悬河。愿意尽自己最大努力帮助别人。 搭建博客做什么？ 分享平时积累下来的经验，...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/rpi-debian-bluetooth/" class="btn btn-outline-primary"><p>为运行非官方 Linux 的树莓派 4B 找回蓝牙功能</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//cyanoxygen.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://blog.cyanoxygen.xyz/posts/HyperV-vs-preserved-ports/'; this.page.identifier = '/posts/HyperV-vs-preserved-ports/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/cyanoxygen">Cyanoxygen</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/rpi/">rpi</a> <a class="post-tag" href="/tags/raspberrypi/">raspberrypi</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/welcome/">welcome</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/hyperv/">hyperv</a> <a class="post-tag" href="/tags/eacces/">eacces</a> <a class="post-tag" href="/tags/debian/">debian</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-175441100-1', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://blog.cyanoxygen.xyz{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
